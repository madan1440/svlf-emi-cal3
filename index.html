
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#4f46e5" />
  <title>SVLF EMI Calculator</title>

  <!-- Manifest (relative path for project subfolder) -->
  <link rel="manifest" href="./manifest.json" />

  <!-- iOS (optional; add icon later if you want) -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <!-- <link rel="apple-touch-icon" href="./icon-192.png" /> -->

  <!-- CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="./style.css" />

  <script>
    // Show/hide interest input groups based on selected interest type
    function toggleInterestFields() {
      const typeInput = document.querySelector('input[name="interest_type"]:checked');
      const type = typeInput ? typeInput.value : 'percent';
      const percentGroup = document.getElementById('interest_percent_group');
      const rupeesGroup = document.getElementById('interest_rupees_group');
      percentGroup.style.display = (type === 'percent') ? 'grid' : 'none';
      rupeesGroup.style.display = (type === 'rupees') ? 'grid' : 'none';
    }
    document.addEventListener('DOMContentLoaded', toggleInterestFields);
  </script>
</head>
<body>
  <div class="app-container">
    <div class="calculator-card">
      <h2 class="title">SVLF EMI Calculator</h2>

      <form class="row g-3">
        <!-- 1) Loan Amount -->
        <div class="form-row">
          <label class="form-label" for="loanAmount">Loan Amount (₹)</label>
          <input id="loanAmount" type="number" class="form-control" name="loan" value="20000" min="0" inputmode="decimal" />
        </div>

        <!-- 2) Tenure -->
        <div class="form-row">
          <label class="form-label" for="tenureMonths">Tenure (months)</label>
          <input id="tenureMonths" type="number" class="form-control" name="months" value="12" min="1" />
        </div>

        <!-- 3) Processing Charges -->
        <div class="form-row">
          <label class="form-label" for="pcPercent">Processing Charges (%)</label>
          <input id="pcPercent" type="number" class="form-control" name="pc_percent" value="10" min="0" step="0.01" />
        </div>

        <!-- 4) Interest (% per year) + toggle -->
        <div class="form-row" id="interest_percent_group">
          <label class="form-label" for="interestPercent">Interest (%/year)</label>
          <div class="inline-field">
            <input id="interestPercent" type="number" class="form-control" name="interest_percent" value="24" min="0" step="0.01" />
            <div class="interest-toggle compact">
              <button type="button" class="it-btn active" data-value="percent">%/yr</button>
              <button type="button" class="it-btn" data-value="rupees">₹/yr</button>
            </div>
            <!-- Hidden radios -->
            <div class="visually-hidden">
              <input type="radio" id="it_percent_A" name="interest_type" value="percent" checked>
              <input type="radio" id="it_rupees_A" name="interest_type" value="rupees">
            </div>
          </div>
        </div>

        <!-- 5) Interest (₹ per year) + toggle -->
        <div class="form-row" id="interest_rupees_group" style="display:none;">
          <label class="form-label" for="interestRupees">Interest (₹/year)</label>
          <div class="inline-field">
            <input id="interestRupees" type="number" class="form-control" name="interest_rupees" value="2" min="0" step="0.01" />
            <div class="interest-toggle compact">
              <button type="button" class="it-btn" data-value="percent">%/yr</button>
              <button type="button" class="it-btn active" data-value="rupees">₹/yr</button>
            </div>
            <!-- Hidden radios -->
            <div class="visually-hidden">
              <input type="radio" id="it_percent_B" name="interest_type" value="percent">
              <input type="radio" id="it_rupees_B" name="interest_type" value="rupees" checked>
            </div>
          </div>
        </div>

        <!-- 6) R.C compact row -->
        <div class="form-row">
          <label class="form-label" for="rcAmount">Include R.C</label>
          <div class="inline-field inline-rc">
            <label class="toggle-label" for="includeRc">
              <input id="includeRc" type="checkbox" name="rc_include" checked />
              <span class="toggle-slider"></span>
            </label>
            <input
              id="rcAmount"
              type="number"
              class="form-control rc-inline-input"
              name="rc_amount"
              value="600"
              min="0"
              step="1"
              placeholder="₹"
              aria-label="R.C amount"
            />
          </div>
        </div>

        <!-- Action -->
        <div class="col-12">
          <button class="btn calculate-btn" type="submit">Calculate EMI</button>
        </div>
      </form>
    </div>

    <!-- Results -->
    <div id="resultBox" class="result-card d-none">
      <div class="emi-box">
        <div class="label">Monthly EMI</div>
        <div class="emi-value">₹ <span id="emi"></span></div>
      </div>
      <div class="result-grid">
        <div class="result-tile">
          <div class="label">Total Payable</div>
          <div class="value">₹ <span id="totalPayable"></span></div>
        </div>
        <div class="result-tile">
          <div class="label">Total Interest</div>
          <div class="value">₹ <span id="totalInterest"></span></div>
        </div>
        <div class="result-tile">
          <div class="label">Processing Charges</div>
          <div class="value">₹ <span id="processingAmount"></span></div>
        </div>
        <div class="result-tile">
          <div class="label">Financed Amount</div>
          <div class="value">₹ <span id="financedAmount"></span></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Calculator logic -->
  <script src="./script.js"></script>

  <!-- Service Worker registration for subfolder scope -->
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker
        .register("./service-worker.js", { scope: "./" })
        .then(reg => console.log("Service Worker registered:", reg.scope))
        .catch(err => console.error("SW registration failed", err));
    }
  </script>
</body>
</html>
